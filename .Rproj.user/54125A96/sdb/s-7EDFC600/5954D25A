{
    "contents" : "# Requirement 1 -----------------------------------------------------------\n\n# Create \"processed, \"processed/merged\" and \"processed/merged/Inertial Signals\" folders in one call.\n# Merged data will be saved in these \"processed/merged\" and \"processed/merged/Inertial Signals\" folders,\n# following the name patterns in \"train\" or \"test\" folders.\nif (!file.exists(\"data/processed/merged/Inertial Signals\")) dir.create(\"data/processed/merged/Inertial Signals\", recursive = TRUE)\n\nsrcDirs <- c(\"data/UCI HAR Dataset/train\", \"data/UCI HAR Dataset/test\")\ntargetDir <- \"data/processed/merged\"\n\n# Since filenames follow a preset pattern, we can just use file names in \"train\" folder\n# and derive file names in \"test\" and \"merged\" folders\nfiles <- list.files(srcDirs[1], recursive = TRUE, include.dirs = FALSE)\nfor (file in files) {\n    f1 <- read.csv(paste(srcDirs[1], file, sep = \"/\"), header = FALSE)\n    testName <- gsub(\"_train\", \"_test\", file)\n    f2 <- read.csv(paste(srcDirs[2], testName, sep = \"/\"), header = FALSE)\n    mergeName <- gsub(\"_train\", \"_merged\", file)\n    write.table(f1, paste(targetDir, mergeName, sep = \"/\"), quote = FALSE, row.names = FALSE,\n                col.names = FALSE)\n    write.table(f2, paste(targetDir, mergeName, sep = \"/\"), quote = FALSE, row.names = FALSE,\n                col.names = FALSE, append = TRUE)\n}\n\n# Requirement 2 -----------------------------------------------------------\n\n# Prepare variable names\nfeatures <- read.csv(\"data/UCI HAR Dataset/features.txt\", sep = \"\", header = FALSE)\nvarNames <- features[, 2]\nmeanPos <- grepl(\"-mean()\", varNames)\nstdPos <- grepl(\"-std()\", varNames)\nnamePos <- meanPos | stdPos\nkeptMeasurements <- data.frame()\n\n# Looking into X_merged.txt reveals that it is of a fixed width format with 561 fields, \n# each with 16 characters (numbers) \nfixedWidth <- rep.int(16, 561)\n\n# Reading the whole X_merged.txt file requires a huge amount of memory. Thus, we\n# need to read records in small chunks.\nlinesToSkip = 0;\nlinesToRead = 500;\nlinesRead = linesToRead\nwhile (linesRead == linesToRead) {\n    merged <- read.fwf(\"data/processed/merged/X_merged.txt\", widths = fixedWidth, header = FALSE, n = linesToRead, skip = linesToSkip)\n    linesRead <- nrow(merged)\n    names(merged) <- varNames\n    subset <- merged[, namePos]\n    keptMeasurements <- rbind(keptMeasurements, subset)\n    linesToSkip <- linesToSkip + linesRead\n}\n\n# Since this takes time to generate, let's save it to a file\nwrite.table(keptMeasurements, file = \"data/processed/keptMeasurements.txt\", )\n\n\n# Requirement 3 ---------------------------------------------------------\n\nactivities <- read.csv(\"data/processed/merged/y_merged.txt\", header = FALSE)\nactivity_labels <- read.csv(\"data/UCI HAR Dataset/activity_labels.txt\", sep = \"\", header = FALSE)\n\n# Create a \"activity\" column in \"activities\" containing descriptive activity names\nactivities$activity <- activity_labels[activities$V1, 2]\n\n# Requirement 4 ---------------------------------------------------------\n\n# Since we have applied varNames to read-in data in Requirement 2, the keptMeasurements\n# has already descriptive variable names.\nkeptMeasurements <- read.table(\"data/processed/keptMeasurements.txt\", check.names=FALSE)\n\n# Need to merge subject, activities, keptMeasurements \nsubject <- read.csv(\"data/processed/merged/subject_merged.txt\", header = FALSE)\nnames(subject) <- c(\"subject\")\n\ncombined <- cbind(subject, activities, keptMeasurements)\ncombined <- combined[, -2]\nwrite.table(combined, file = \"data/processed/combined.txt\")\n\n# Requirement 5 ---------------------------------------------------------\n\ncombined <- read.table(\"data/processed/combined.txt\", check.names=FALSE)\nlibrary(dplyr)\n# Finding the average of each variable for each activity and each subject.\ntidySet <- combined %>% group_by(subject, activity) %>% summarise_each(funs(mean))\n\n# However, the column names that \"tidySet\" inherited from \"combined\" are not correct any more,\n# except for \"subject\" and \"activity\". We need to change the name like \"tBodyAcc-mean()-X\" \n# to \"avg of tBodyAcc-mean()-X\", and attached the proper variable names to \"tidySet\"\nnewColNames <- paste(\"avg of\", names(tidySet))\nnewColNames[1] <- names(tidySet)[1]\nnewColNames[2] <- names(tidySet)[2]\nnames(tidySet) <- newColNames\n\n# Finally, we write out \"tidySet\" to a file with with write.table() using row.name=FALSE\nwrite.table(tidySet, file = \"data/processed/tidySet.txt\", row.name=FALSE)\n",
    "created" : 1429848493285.000,
    "dirty" : true,
    "encoding" : "ASCII",
    "folds" : "",
    "hash" : "1030221897",
    "id" : "5954D25A",
    "lastKnownWriteTime" : 1429981881,
    "path" : "C:/Projects/R/tidyDataProject/run_analysis.R",
    "project_path" : "run_analysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}